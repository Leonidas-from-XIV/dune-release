<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sos (dune-release.Dune_release.Sos)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dune-release</a> &#x00BB; <a href="../index.html">Dune_release</a> &#x00BB; Sos</nav><h1>Module <code>Dune_release.Sos</code></h1></header><aside><p>Safe OS operations.</p><p>All the commands in that module can have side-effects. They also all take a <code>--dry-run</code> paramater which cause the side-effect to be discarded and to display a message instead. Some of these commands also have a `<code>--force</code>` option: this causes the message to be printed AND the side-effects to be caused.</p></aside><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code><code> = Bos_setup.R.msg</code></dt></dl><dl><dt class="spec value" id="val-show"><a href="#val-show" class="anchor"></a><code><span class="keyword">val</span> show : <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> <span>?&#8288;action:<span>[ `Done <span>| `Skip</span> ]</span></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, Stdlib.Format.formatter, unit, <span><span>(unit, <span class="type-var">'b</span>)</span> Stdlib.result</span>)</span> Stdlib.format4</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dt class="spec value" id="val-cmd_error"><a href="#val-cmd_error" class="anchor"></a><code><span class="keyword">val</span> cmd_error : Bos.Cmd.t <span>&#45;&gt;</span> <span>string option</span> <span>&#45;&gt;</span> Bos.OS.Cmd.status <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, Rresult.R.msg)</span> Stdlib.result</span></code></dt><dd><p><code>cmd_error cmd ~stderr status</code> returns an error message describing the failing command <code>cmd</code>, the exit status <code>status</code> and, if existent, also the error message <code>err_msg</code>.</p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-run_quiet"><a href="#val-run_quiet" class="anchor"></a><code><span class="keyword">val</span> run_quiet : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p>Same as run but redirects err and out to null</p></dd></dl><dl><dt class="spec value" id="val-run_io"><a href="#val-run_io" class="anchor"></a><code><span class="keyword">val</span> run_io : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> <span>default:<span class="type-var">'a</span></span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> Bos.OS.Cmd.run_in <span>&#45;&gt;</span> <span>(Bos.OS.Cmd.run_out <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-run_out"><a href="#val-run_out" class="anchor"></a><code><span class="keyword">val</span> run_out : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> <span>?&#8288;err:Bos.OS.Cmd.run_err</span> <span>&#45;&gt;</span> <span>default:<span class="type-var">'a</span></span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> <span>(Bos.OS.Cmd.run_out <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> Stdlib.result</span></code></dt></dl><dl><dt class="spec type" id="type-response"><a href="#type-response" class="anchor"></a><code><span class="keyword">type</span> <span>'a response</span></code><code> = </code><code>{</code><table class="record"><tr id="type-response.output" class="anchored"><td class="def field"><a href="#type-response.output" class="anchor"></a><code>output : <span class="type-var">'a</span>;</code></td></tr><tr id="type-response.err_msg" class="anchored"><td class="def field"><a href="#type-response.err_msg" class="anchor"></a><code>err_msg : string;</code></td></tr><tr id="type-response.status" class="anchored"><td class="def field"><a href="#type-response.status" class="anchor"></a><code>status : Bos.OS.Cmd.status;</code></td></tr><tr id="type-response.run_info" class="anchored"><td class="def field"><a href="#type-response.run_info" class="anchor"></a><code>run_info : Bos.OS.Cmd.run_info;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-run_out_err"><a href="#val-run_out_err" class="anchor"></a><code><span class="keyword">val</span> run_out_err : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> <span>default:<span>(<span class="type-var">'a</span> * Bos.OS.Cmd.run_status)</span></span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> <span>(Bos.OS.Cmd.run_out <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * Bos.OS.Cmd.run_status, <span>[&gt; Rresult.R.msg ]</span> <span class="keyword">as</span> 'b)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> <a href="index.html#type-response">response</a></span>, <span class="type-var">'b</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-run_status"><a href="#val-run_status" class="anchor"></a><code><span class="keyword">val</span> run_status : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>?&#8288;sandbox:bool</span> <span>&#45;&gt;</span> Bos.Cmd.t <span>&#45;&gt;</span> <span><span>(Bos.OS.Cmd.status, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-delete_dir"><a href="#val-delete_dir" class="anchor"></a><code><span class="keyword">val</span> delete_dir : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-delete_path"><a href="#val-delete_path" class="anchor"></a><code><span class="keyword">val</span> delete_path : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-read_file"><a href="#val-read_file" class="anchor"></a><code><span class="keyword">val</span> read_file : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(string, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-write_file"><a href="#val-write_file" class="anchor"></a><code><span class="keyword">val</span> write_file : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-with_dir"><a href="#val-with_dir" class="anchor"></a><code><span class="keyword">val</span> with_dir : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-file_exists"><a href="#val-file_exists" class="anchor"></a><code><span class="keyword">val</span> file_exists : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(bool, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-dir_exists"><a href="#val-dir_exists" class="anchor"></a><code><span class="keyword">val</span> dir_exists : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(bool, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-file_must_exist"><a href="#val-file_must_exist" class="anchor"></a><code><span class="keyword">val</span> file_must_exist : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(Fpath.t, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-out"><a href="#val-out" class="anchor"></a><code><span class="keyword">val</span> out : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> * Bos.OS.Cmd.run_status</code></dt><dt class="spec value" id="val-mkdir"><a href="#val-mkdir" class="anchor"></a><code><span class="keyword">val</span> mkdir : <span>dry_run:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(bool, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-cp"><a href="#val-cp" class="anchor"></a><code><span class="keyword">val</span> cp : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>rec_:bool</span> <span>&#45;&gt;</span> <span>force:bool</span> <span>&#45;&gt;</span> <span>src:Fpath.t</span> <span>&#45;&gt;</span> <span>dst:Fpath.t</span> <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>cp ~dry_run ~rec ~force ~src ~dst</code> copies <code>src</code> to <code>dst</code>. If <code>rec</code> is true, copies directories recursively. If <code>force</code> is true, overwrite existing files. The usual <code>force</code> arguments from other functions in this module is renamed <code>force_side_effects</code> here.</p></dd></dl><dl><dt class="spec value" id="val-relativize"><a href="#val-relativize" class="anchor"></a><code><span class="keyword">val</span> relativize : <span>src:Fpath.t</span> <span>&#45;&gt;</span> <span>dst:Fpath.t</span> <span>&#45;&gt;</span> <span><span>(Fpath.t, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>relativize ~src ~dst</code> return a relative path from <code>src</code> to <code>dst</code>. If such a path can't be expressed, i.e. <code>srs</code> and <code>dst</code> don't have a common root, returns an error.</p></dd></dl></div></body></html>