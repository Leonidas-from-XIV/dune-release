<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Archive (dune-release.Dune_release.Archive)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dune-release</a> &#x00BB; <a href="../index.html">Dune_release</a> &#x00BB; Archive</nav><h1>Module <code>Dune_release.Archive</code></h1><nav class="toc"><ul><li><a href="#ustar-archives">Ustar archives</a></li><li><a href="#bzip2-compression-and-unarchiving">Bzip2 compression and unarchiving</a></li></ul></nav></header><aside><p>Archive creation.</p></aside><section><header><h2 id="ustar-archives"><a href="#ustar-archives" class="anchor"></a>Ustar archives</h2></header><dl><dt class="spec value" id="val-tar"><a href="#val-tar" class="anchor"></a><code><span class="keyword">val</span> tar : Fpath.t <span>&#45;&gt;</span> <span>exclude_paths:Fpath.set</span> <span>&#45;&gt;</span> <span>root:Fpath.t</span> <span>&#45;&gt;</span> <span>mtime:int</span> <span>&#45;&gt;</span> <span><span>(string, Bos_setup.R.msg)</span> Bos_setup.result</span></code></dt><dd><p><code>tar dir ~exclude_paths ~root ~mtime</code> is a (us)tar archive that contains the file hierarchy <code>dir</code> except the relative hierarchies present in <code>exclude_paths</code>. In the archive, members of <code>dir</code> are rerooted at <code>root</code> and sorted according to <span class="xref-unresolved" title="unresolved reference to &quot;Fpath.compare&quot;"><code>Fpath</code>.compare</span>. They have their modification time set to <code>mtime</code> and their file permissions are <code>0o775</code> for directories and files executable by the user and <code>0o664</code> for other files. No other file metadata is preserved.</p><p><b>Note.</b> This is a pure OCaml implementation, no <code>tar</code> tool is needed.</p></dd></dl></section><section><header><h2 id="bzip2-compression-and-unarchiving"><a href="#bzip2-compression-and-unarchiving" class="anchor"></a>Bzip2 compression and unarchiving</h2></header><dl><dt class="spec value" id="val-ensure_bzip2"><a href="#val-ensure_bzip2" class="anchor"></a><code><span class="keyword">val</span> ensure_bzip2 : unit <span>&#45;&gt;</span> <span><span>(unit, Bos_setup.R.msg)</span> Bos_setup.result</span></code></dt><dd><p><code>ensure_bzip2 ()</code> makes sure the <code>bzip2</code> utility is available.</p></dd></dl><dl><dt class="spec value" id="val-bzip2"><a href="#val-bzip2" class="anchor"></a><code><span class="keyword">val</span> bzip2 : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;force:bool</span> <span>&#45;&gt;</span> <span>dst:Fpath.t</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(unit, Bos_setup.R.msg)</span> Bos_setup.result</span></code></dt><dd><p><code>bzip2 dst s</code> compresses <code>s</code> to <code>dst</code> using bzip2.</p></dd></dl><dl><dt class="spec value" id="val-untbz"><a href="#val-untbz" class="anchor"></a><code><span class="keyword">val</span> untbz : <span>dry_run:bool</span> <span>&#45;&gt;</span> <span>?&#8288;clean:bool</span> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <span><span>(Fpath.t, Bos_setup.R.msg)</span> Bos_setup.result</span></code></dt><dd><p><code>untbz ~clean ar</code> untars the tar bzip2 archive <code>ar</code> in the same directory as <code>ar</code> and returns a base directory for <code>ar</code>. If <code>clean</code> is <code>true</code> (defaults to <code>false</code>) first delete the base directory if it exists.</p></dd></dl></section></div></body></html>